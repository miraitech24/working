# 量子耐性 CBDC セキュリティモデル報告

## 1. プロジェクトの要約と目的

本プロジェクトは、リーマン予想に裏打ちされた古典的な暗号（RSA）のセキュリティ基盤が、量子コンピュータ（Shor/Groverアルゴリズム）の出現により**根本的に崩壊する**という予測に基づき、**量子耐性（PQC: Post-Quantum Cryptography）**技術を適用した中央銀行デジタル通貨（CBDC）のセキュリティモデルを構築することを目的としました。

---

## 2. 古典セキュリティの起源と限界（解析学的基盤）

### 2.1 リーマン・ゼータ関数による厳密性の確立 (古典暗号の土台)

* **古典暗号の土台:** RSA暗号の安全性は、**素因数分解の困難性**に完全に依存し、これは素数の分布に関する理論、すなわち**リーマン・ゼータ関数 $\zeta(s)$** に裏付けられています。
* **検証:** Maximaによる解析的検証により、$\zeta(s)$ の関数方程式 $\xi(s) = \xi(1-s)$ の対称性、および最初の非自明な零点の数値的厳密性を確認しました。 
* **結論:** 古典暗号のセキュリティは極めて厳密な数学的基盤を持っていますが、その強さは**素数の非線形な困難性**に限定されます。

---

## 3. 量子脅威と**計算複雑性の普遍的困難性**

### 3.1 P≠NP問題と量子耐性暗号の根拠

古典暗号（RSA）の安全性は素数分布という**解析学的な困難性**に依拠していましたが、量子耐性暗号（格子暗号）の安全性は、より普遍的な**計算複雑性理論**に根ざしています。

* **NP完全性:** P≠NP問題が肯定された場合、**SAT（充足可能性問題）**などのNP完全問題は、量子コンピュータをもってしても多項式時間では解けません。 
* **格子暗号とNP困難性:** 格子暗号のセキュリティは、**最短ベクトル問題 (SVP)** や**最近ベクトル問題 (CVP)** の困難性に基づいています。これらの問題は、NP困難な問題と等価であると証明されており、P≠NPが成り立つ限り、**量子コンピュータでも指数時間（またはそれに近い）の計算量が必要**となります。

### 3.2 Shorのアルゴリズムによる解析的困難性の崩壊

Shorのアルゴリズムは、RSAの困難性を司る**素因数分解**を多項式時間 $O(L^3)$ で解決します。
                         |
|:------------------ |:------------------ |:--------------------------- |:----------------------------------- |
| **RSA (2048 bit)** | $O(\exp(L^{1/3}))$ | $O(L^3)$ (多項式時間)            | **壊滅的:** **指数関数的困難性**が**多項式時間**に崩壊。 |
| **PQC (格子暗号)**     | $O(\exp(C_{dim}))$ | $O(\exp(C_{dim}))$ (指数時間維持) | **耐性あり:** 量子時代でも困難性を維持。             |

### 3.3 Groverのアルゴリズムの影響

対称鍵（ハッシュなど）はShorの脅威は受けませんが、Groverのアルゴリズムにより実効セキュリティが**半分**に減少します。

* **対策:** CBDCの真正性を担保するハッシュ関数として、量子耐性を考慮し、**512 bits (SHA3-512)** を採用しました。（実効セキュリティ $256$ bits 相当を確保）

---

## 4. 量子耐性 CBDC セキュリティモデルの構築

本モデルは、**格子暗号**と**ハッシュベース署名**の二つの主要なPQC技術を採用することで、CBDCトランザクションの機密性と真正性を保証します。

| PQC コンポーネント   | 役割                             | 採用技術                        | 厳密性の根拠                              |
|:------------- |:------------------------------ |:--------------------------- |:----------------------------------- |
| **暗号化 / 鍵交換** | トランザクションの機密性 (Confidentiality) | 格子暗号 (LWE, RLWEに基づく)        | **SVP/CVP問題**の困難性。P≠NPの普遍的困難性に依拠する。 |
| **署名 / 真正性**  | 取引の改ざん防止 (Integrity)           | ハッシュベース署名 (XMSS/SPHINCS+概念) | **ハッシュ関数**のみに依存し、量子証明可能な安全性         |

### 4.1 格子暗号パラメータ (`lattice_params.json`に基づく)

* **次元 $n/m$:** $256/512$
* **モジュラス $q$:** $3329$
* **ノイズ $\sigma$:** $1.5$ 

### 4.2 ハッシュベース署名パラメータ (`signature_params.json`に基づく)

* **アルゴリズム:** SHA3-512
* **実効セキュリティ:** $256$ bits (Grover耐性を考慮した倍増)
* **構造:** ワンタイム署名（OTS）に基づくマークルツリー構造

### 4.3 PQC候補の比較と格子暗号の優位性 (参考/備考)

量子耐性暗号の候補は複数存在しますが、CBDCのような金融インフラにおける**「理論的堅牢性」**と**「実用性」**の観点から、格子暗号が最も優位であると判断されます。

| 候補技術                   | 困難性の基盤      | 理論的保証                                      | 主な欠点                      |
|:---------------------- |:----------- |:------------------------------------------ |:------------------------- |
| **格子暗号 (Lattice)**     | **SVP/CVP** | **P≠NP問題**と直接連関する唯一の主要候補であり、最強の理論的裏付けを持つ。  | 鍵サイズが古典暗号より大きい。           |
| **符号ベース (Code-based)** | **復号困難性問題** | 安全性の歴史は長いが、P≠NPとの直接連関はない。                  | 鍵サイズが**非常に大きい**ため、実用性に劣る。 |
| **多変数多項式 (MQ)**        | **MQ問題**    | P≠NPと関連するが、厳密な還元が複雑で、一部の攻撃に対する脆弱性が報告されている。 | セキュリティの歴史が浅い。             |

**優位性の結論:** 格子暗号は、**普遍的な計算限界（P≠NP）**に基づく**理論的堅牢性**と、**NIST標準化**による**実用性**を両立しており、CBDCの長期的なセキュリティ基盤として最適な選択です。

---

## 5. 最終結論

本プロジェクトは、以下の厳密な論理連鎖に基づいて、CBDCセキュリティモデルの移行を結論づけます。

1. **古典的厳密性:** リーマン予想に代表される**解析学的な困難性**（素因数分解の困難性）は、古典暗号（RSA）の安全性に絶対的な信頼を与えていた。
2. **量子技術による崩壊:** 量子コンピュータの**Shorのアルゴリズム**は、**リーマン予想そのものを破るわけではない**が、その予想に間接的に基づく**素因数分解の計算困難性**を多項式時間で破綻させた。
3. **セキュリティの破綻:** この結果、**RSA暗号は量子的に無力化（Compromised）**され、古典的なセキュリティの前提は完全に崩壊した。
4. **普遍的困難性への移行:** 代替として、格子暗号の困難性（SVP/CVP）は**計算複雑性理論の普遍的困難性（P≠NP）**に裏打ちされており、量子時代においてもその安全性が維持される。

**結論:** CBDCのセキュリティ基盤を、**「破られた解析学的困難性」**から**「普遍的かつ量子耐性のある計算困難性」**へと移行させる必要は絶対的です。これらのPQCコンポーネントを即座に導入し、量子時代における金融システムのセキュリティ基盤を確立することを強く推奨します。
